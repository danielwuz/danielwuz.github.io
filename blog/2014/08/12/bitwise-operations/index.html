
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Bitwise Operations - Daniel Wu's Blog</title>
  <meta name="author" content="Daniel Wu">

  
  <meta name="description" content="I recently took an online course Hardware/Software Interface on Coursera, offered by University of Washington. It&rsquo;s a great course, and brought &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://danielwuz.github.io/blog/2014/08/12/bitwise-operations">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Daniel Wu's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<script src="/javascripts/custom.js" type="text/javascript"></script>
<!-- <script src="/javascripts/footnote.js" type="text/javascript"></script> -->
<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
    multiLine: true,
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Daniel Wu's Blog</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:danielwuz.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Bitwise Operations</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-12T07:01:23-04:00" pubdate data-updated="true">Aug 12<sup>th</sup>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I recently took an online course <a href="https://class.coursera.org/hwswinterface-002">Hardware/Software Interface</a> on Coursera, offered by University of Washington. It&rsquo;s a great course, and brought my memory to those good old days back in school many years ago. In the first lecture, the professor talked about how computer handles numbers through bitwise operation. Although nowadays, the majority of programmers are programming in high-level languages, I believe as a programmer, it&rsquo;s important for us to understand what these basics are and how to use them effectively.</p>

<p>If you haven&rsquo;t studied this topic thoroughly, or need to refresh your memory, take a look at the &ldquo;Resources&rdquo; section, as I&rsquo;ve listed couple resources there for you to reference. In this blog post, I&rsquo;ll be showing you some of the moset common bitwise operation.</p>

<h2>Application</h2>

<h3>Check if two variables have the same signs</h3>

<p>Two variables <code>x</code> and <code>y</code> are both positive or both negative if <code>(x &gt; 0) ^ (y &gt; 0) == 0</code></p>

<h3>Extract the 2nd most significant byte of an integer</h3>

<p>First shift, then mask: <code>(x &gt;&gt; 17) &amp; 0xFF</code></p>

<h3>Extract the sign of an integer:</h3>

<p>Use <code>&amp; 1</code> to clear out all other bits except LSB: <code>(x &gt;&gt; 31) &amp; 1</code></p>

<h3>Conditionals as Boolean expressions</h3>

<p>Assuming x is 0 or 1, an <code>if-else</code> statement</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="k">if</span> <span class="o">(</span><span class="n">x</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">a</span> <span class="o">=</span> <span class="n">y</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'>  <span class="n">a</span> <span class="o">=</span> <span class="n">z</span><span class="o">;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>which is the same as <code>a = x ? y : z;</code></p>

<p>can be rewritten as: <code>a = ((x &lt;&lt; 31) &gt;&gt; 31) &amp; y + ((!x) &lt;&lt; 31</code> on a 32-bit machine.</p>

<h3>Determining if an integer is a power of 2</h3>

<p>We can determine if an integer is power of 2 by <code>(v &amp; (v - 1)) == 0;</code>, assuming 0 is not considered as power of 2.</p>

<h3>Compute exponentiation</h3>

<p>Supporse we&rsquo;d like to compute the exponentiation operation of $x^y$ in real numbers, the brute-force way is to multiply $x$ by itself $y$ times, as in below code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&#39;&#39;&#39; compute x**y &#39;&#39;&#39;</span>
</span><span class='line'>    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
</span><span class='line'>        <span class="n">result</span> <span class="o">*=</span> <span class="n">x</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">result</span>
</span></code></pre></td></tr></table></div></figure>


<p>The complexity of this approach is in the order of the length of $y$, which is exponential in binary.</p>

<p>Observe that $x^y$ can be computed in below equation:</p>

<p>$$
\begin{equation}
  x^y =
  \begin{cases}
  (x^\frac{y}{2})^2 &amp; \text{if } y \text{ mod } 2 = 0, \cr
  (x^\frac{y}{2})^2 * x &amp; \text{if } y \text{ mod } 2 = 1.
  \end{cases}
\end{equation}
$$</p>

<p>We can use a recursive function to implement above logic:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&#39;&#39;&#39; compute x**y &#39;&#39;&#39;</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="n">x</span>
</span><span class='line'>    <span class="n">tmp</span> <span class="o">=</span> <span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">y</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">tmp</span> <span class="o">*</span> <span class="n">tmp</span>
</span><span class='line'>    <span class="k">else</span><span class="p">:</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">tmp</span> <span class="o">*</span> <span class="n">tmp</span> <span class="o">*</span> <span class="n">x</span>
</span></code></pre></td></tr></table></div></figure>


<p>Running time of this computation is logarithmic to the value of $y$, therefore linear to the length of $y$ in binary.</p>

<p>A third way is to utilize bit shifting operation. Think this way, suppose we can represent $y$ in binary $k_1k_2..k_i..k_n$, where $k_i$ has value either 0 or 1, we can compute $x^y$ like below:
$$
x^y = x^{k_1k_2..k_i} = \prod{x^{k_i}} \text{ where } ith \text{ bit } = 1
$$
For example, $2^{10}$ can be written as
$$
2^{10_{10}} = 2^{1010_2} = 2^{1000_2} * 2^{0010_2}
$$</p>

<p>Therefore, we can continuously shift $y$ to the right and check its $i$th bit until all bits are checked, as shown in below python code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span class='line'>    <span class="sd">&#39;&#39;&#39;computes x**y &#39;&#39;&#39;</span>
</span><span class='line'>    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">while</span> <span class="n">y</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span class='line'>        <span class="k">if</span> <span class="n">y</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span class='line'>            <span class="n">result</span> <span class="o">*=</span> <span class="n">x</span>
</span><span class='line'>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
</span><span class='line'>        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">result</span>
</span></code></pre></td></tr></table></div></figure>


<p>Comparing the the second approach, bit shifting way is faster because bitwise operation is faster as it avoids the overhead of function calls and call stack management, as opposed to recursive function call.</p>

<p>If you still don&rsquo;t understand how this algorithm works, I encourage you take a piece of paper and a pen, and work out a concrete example.</p>

<h1>Resources</h1>

<p>There are more to say about bitwise operation. I&rsquo;ve listed here some good articles and videos below that talk about it in a decent depth.</p>

<ul>
<li><a href="https://www.youtube.com/playlist?list=PL726AB973C6E39758">Understanding Binary Numbers</a>: A series of videos on Youtube designed to improve your understanding of binary numbers, including how to add, subtract, multiply and divide binary numbers.</li>
<li><a href="http://www.cprogramming.com/tutorial/bitwise_operators.html">Bitwise Operators in C and C++: A Tutorial</a>:</li>
<li><a href="http://stackoverflow.com/questions/141525/absolute-beginners-guide-to-bit-shifting">Discussion on StackOverflow</a>: some suggestions for absolute beginners to bit shifting.</li>
<li><a href="https://graphics.stanford.edu/~seander/bithacks.html">Bit Twiddling Hacks</a>:</li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Daniel Wu</span></span>

      








  


<time datetime="2014-08-12T07:01:23-04:00" pubdate data-updated="true">Aug 12<sup>th</sup>, 2014</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://danielwuz.github.io/blog/2014/08/12/bitwise-operations/" data-via="" data-counturl="http://danielwuz.github.io/blog/2014/08/12/bitwise-operations/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/07/29/fastest-way-to-compute-fibonnaci-numbers/" title="Previous Post: Fastest Way to Compute Fibonacci Numbers">&laquo; Fastest Way to Compute Fibonacci Numbers</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/12/12/show-progress-while-downloading-in-elisp/" title="Next Post: Show progress while downloading in Elisp">Show progress while downloading in Elisp &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/12/12/show-progress-while-downloading-in-elisp/">Show Progress While Downloading in Elisp</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/12/bitwise-operations/">Bitwise Operations</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/29/fastest-way-to-compute-fibonnaci-numbers/">Fastest Way to Compute Fibonacci Numbers</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/26/firefox-customization-for-programmers/">Firefox Customization for Programmers</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/23/my-first-blog/">My First Blog</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Daniel Wu -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'danielwuz';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://danielwuz.github.io/blog/2014/08/12/bitwise-operations/';
        var disqus_url = 'http://danielwuz.github.io/blog/2014/08/12/bitwise-operations/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
